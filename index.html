<!DOCTYPE html>
<html lang="tr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>İngilizce-Türkçe Kelimeler</title>
	<style>
		body {
			font-family: 'Segoe UI', Arial, sans-serif;
			background: #f7f7f7;
			margin: 0;
			padding: 0;
		}
		.container {
			max-width: 700px;
			margin: 40px auto;
			background: #fff;
			border-radius: 12px;
			box-shadow: 0 2px 8px rgba(0,0,0,0.08);
			padding: 32px;
		}
		h1 {
			text-align: center;
			color: #333;
			margin-bottom: 24px;
		}
		table {
			width: 100%;
			border-collapse: collapse;
		}
		th, td {
			padding: 12px 8px;
			text-align: left;
		}
		th {
			background: #e3eafc;
			color: #2a3a5e;
			font-size: 1.1em;
		}
		tr:nth-child(even) {
			background: #f0f4fa;
		}
		tr:hover {
			background: #dbeafe;
		}
	</style>
	<!-- jQuery ve DataTables CDN -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
	<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
</head>

<body>
	<div class="container">
		<div style="display: flex; flex-direction:column; align-items: flex-start; gap: 0;">
			
			<h1 style="margin-bottom:16px; align-self:center;">İngilizce - Türkçe Kelimeler</h1>
			<div style="display:flex; gap:16px; align-items:center; margin-bottom:16px; align-self:center;">
				<label style="font-size:0.95em;">
					<input type="checkbox" id="toggleEnglish" checked style="vertical-align:middle;"> İngilizceyi Göster
				</label>
				<label style="font-size:0.95em;">
					<input type="checkbox" id="toggleTurkish" checked style="vertical-align:middle;"> Türkçeyi Göster
				</label>
				<button id="addWordBtn" style="padding:2px 12px; background:#2a3a5e; color:#fff; border:none; border-radius:6px; cursor:pointer; font-size:1em;">+</button>
				<input type="file" id="csvUpload" accept=".csv" style="display:none" />
				<button id="uploadCsvBtn" style="padding:2px 12px; background:#6c757d; color:#fff; border:none; border-radius:6px; cursor:pointer; font-size:1em;">CSV Yükle</button>
				<button id="clearTableBtn" style="padding:2px 12px; background:#e70615; color:#fff; border:none; border-radius:6px; cursor:pointer; font-size:1em;">Temizle</button>
			</div>
		</div>
		<br />
		<div style="display:flex; gap:16px; margin-bottom:12px">
	<!-- Arama inputu kaldırıldı -->
		</div>
		<table id="wordsTable">
			<thead>
				<tr>
					<th style="width:40px; text-align:center;">No</th>
					<th>İngilizce</th>
					<th>Türkçe</th>
					<th style="width:90px; text-align:center;">İşlem</th>
				</tr>
				<!-- Arama inputu kaldırıldı, yukarıya taşındı -->
			</thead>
			<tbody>
				<!-- ...existing code... -->
				<tr><td>1</td><td>İngilizce</td><td>Türkçe</td><td class="actions"></td></tr>
				
				<!-- ...devamı için ekleme yapılabilir... -->
			</tbody>
		</table>
	</div>


	<!-- Modal: Yeni Kayıt Ekle & Düzenle -->
	<div id="addModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000; justify-content:center; align-items:center;">
		<div style="background:#fff; padding:32px 24px; border-radius:12px; box-shadow:0 2px 16px rgba(0,0,0,0.15); min-width:320px; max-width:90vw;">
			<h2 id="modalTitle" style="margin-top:0;">Yeni Kayıt Ekle</h2>
			<form id="addWordForm" autocomplete="off">
				<div style="margin-bottom:16px;">
					<label>İngilizce:</label><br>
					<input type="text" id="englishInput" style="width:100%; padding:8px; font-size:1em;" required>
				</div>
				<div style="margin-bottom:16px;">
					<label>Türkçe:</label><br>
					<input type="text" id="turkishInput" style="width:100%; padding:8px; font-size:1em;" required>
				</div>
				<div style="display:flex; justify-content:flex-end; gap:8px;">
					<button type="button" id="cancelBtn" style="padding:8px 16px; background:#eee; border:none; border-radius:6px; cursor:pointer;">İptal</button>
					<button type="submit" style="padding:8px 16px; background:#2a3a5e; color:#fff; border:none; border-radius:6px; cursor:pointer;">Kaydet</button>
				</div>
			</form>
		</div>
	</div>

	<script>
	// Toast gösterme
	function showToast(message) {
		let toast = document.getElementById('toastMsg');
		if (!toast) {
			toast = document.createElement('div');
			toast.id = 'toastMsg';
			toast.style.position = 'fixed';
			toast.style.left = '50%';
			toast.style.bottom = '32px';
			toast.style.transform = 'translateX(-50%)';
			toast.style.background = '#2a3a5e';
			toast.style.color = '#fff';
			toast.style.padding = '12px 32px';
			toast.style.borderRadius = '8px';
			toast.style.fontSize = '1.1em';
			toast.style.boxShadow = '0 2px 8px rgba(0,0,0,0.15)';
			toast.style.zIndex = '9999';
			document.body.appendChild(toast);
		}
		toast.textContent = message;
		toast.style.display = 'block';
		setTimeout(() => { toast.style.display = 'none'; }, 2000);
	}
	// Sütunları gizle/göster
	function updateColumnVisibility() {
		const showEng = document.getElementById('toggleEnglish').checked;
		const showTr = document.getElementById('toggleTurkish').checked;
		// Başlık
		const ths = document.querySelectorAll('#wordsTable thead th');
		ths[0].style.display = showEng ? '' : 'none';
		ths[1].style.display = showTr ? '' : 'none';
		// Satırlar
		document.querySelectorAll('#wordsTable tbody tr').forEach(row => {
			row.cells[0].style.display = showEng ? '' : 'none';
			row.cells[1].style.display = showTr ? '' : 'none';
		});
	}
	document.getElementById('toggleEnglish').onchange = updateColumnVisibility;
	document.getElementById('toggleTurkish').onchange = updateColumnVisibility;
	// Modal aç/kapat
	const addWordBtn = document.getElementById('addWordBtn');
	const addModal = document.getElementById('addModal');
	const cancelBtn = document.getElementById('cancelBtn');
	const modalTitle = document.getElementById('modalTitle');
	const englishInput = document.getElementById('englishInput');
	const turkishInput = document.getElementById('turkishInput');
	let editRow = null;

	addWordBtn.onclick = () => {
		modalTitle.textContent = 'Yeni Kayıt Ekle';
		englishInput.value = '';
		turkishInput.value = '';
		editRow = null;
		addModal.style.display = 'flex';
	};
	cancelBtn.onclick = () => { addModal.style.display = 'none'; };

	// Kayıt ekleme/düzenleme
	document.getElementById('addWordForm').onsubmit = function(e) {
		e.preventDefault();
		const eng = englishInput.value.trim();
		const tr = turkishInput.value.trim();
		if(eng && tr) {
			if(editRow) {
				editRow.cells[1].innerText = eng;
				editRow.cells[1].innerText = tr;
			} else {
				const table = document.getElementById('wordsTable').getElementsByTagName('tbody')[0];
				const newRow = table.insertRow();
				newRow.insertCell(0).innerText = eng;
				newRow.insertCell(1).innerText = tr;
				const actionsCell = newRow.insertCell(2);
				actionsCell.className = 'actions';
			}
			addModal.style.display = 'none';
			document.getElementById('addWordForm').reset();
			setTimeout(() => addActionButtons(), 100); // yeni satıra buton ekle
		}
	};
	// Modalı arka plana tıklayınca kapat
	addModal.onclick = function(e) {
		if(e.target === addModal) addModal.style.display = 'none';
	};

	function saveTableToStorage() {
    const rows = document.querySelectorAll('#wordsTable tbody tr');
    const data = [];
    rows.forEach(row => {
        if(row.cells.length === 4) {
            data.push({
                english: row.cells[1].innerText,
                turkish: row.cells[2].innerText
            });
        }
    });
    localStorage.setItem('kelimeTablosu', JSON.stringify(data));
}

function loadTableFromStorage() {
    const table = document.getElementById('wordsTable').getElementsByTagName('tbody')[0];
    table.innerHTML = '';
    const data = JSON.parse(localStorage.getItem('kelimeTablosu') || '[]');
    data.forEach(item => {
        addWordToTable(item.english, item.turkish);
    });
}

window.onload = function() {
    loadTableFromStorage();
    addActionButtons();
    updateColumnVisibility();
    // Kolon göster/gizle
    document.getElementById('toggleEnglish').onchange = function() {
        const show = this.checked;
        document.querySelectorAll('#wordsTable th:nth-child(2), #wordsTable td:nth-child(2)').forEach(cell => {
            cell.style.display = show ? '' : 'none';
        });
    };
    document.getElementById('toggleTurkish').onchange = function() {
        const show = this.checked;
        document.querySelectorAll('#wordsTable th:nth-child(3), #wordsTable td:nth-child(3)').forEach(cell => {
            cell.style.display = show ? '' : 'none';
        });
    };
    document.getElementById('clearTableBtn').onclick = function() {
        if(confirm('Tüm kelimeleri silmek istediğinize emin misiniz?')) {
            const tbody = document.getElementById('wordsTable').getElementsByTagName('tbody')[0];
            while(tbody.firstChild) tbody.removeChild(tbody.firstChild);
            saveTableToStorage();
        }
    };
    document.getElementById('uploadCsvBtn').onclick = function() {
        document.getElementById('csvUpload').click();
    };
    document.getElementById('csvUpload').onchange = function(e) {
        showLoading(true);
        const file = e.target.files[0];
        if (!file) { showLoading(false); return; }
        const reader = new FileReader();
        reader.onload = function(evt) {
            const text = evt.target.result;
            const lines = text.split(/\r?\n/).filter(l => l.trim());
            if (lines.length < 2) {
                alert('CSV dosyası en az başlık ve bir veri satırı içermeli!');
                showLoading(false);
                return;
            }
            // Her zaman ilk satırı başlık olarak atla
            for (let i = 1; i < lines.length; i++) {
                const cols = lines[i].split(/,|;|\t/);
                if (cols.length < 2) continue;
                let eng = cols[0].replace(/"/g, '').trim();
                let tr = cols[1].replace(/"/g, '').trim();
                // Türkçe karakterleri doğru şekilde işle
                eng = decodeURIComponent(escape(eng));
                tr = decodeURIComponent(escape(tr));
                if (!eng || !tr) continue;
                let exists = false;
                document.querySelectorAll('#wordsTable tbody tr').forEach(row => {
                    const tdEng = row.cells[1];
                    const tdTr = row.cells[2];
                    if (tdEng && tdTr && tdEng.innerText.trim() === eng && tdTr.innerText.trim() === tr) {
                        exists = true;
                    }
                });
                if (!exists) {
                    addWordToTable(eng, tr);
                }
            }
            setTimeout(() => {
                addActionButtons();
                saveTableToStorage();
                if ($.fn.DataTable.isDataTable('#wordsTable')) {
                    $('#wordsTable').DataTable().destroy();
                }
                $('#wordsTable').DataTable({
                    language: {
                        url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/tr.json'
                    },
                    paging: true,
                    searching: true,
                    ordering: true,
                    info: true
                });
                showLoading(false);
                alert('CSV kelimeleri başarıyla eklendi!');
            }, 100);
        };
        reader.readAsText(file, 'UTF-8');
    };
}

function addWordToTable(english, turkish) {
    const table = document.getElementById('wordsTable').getElementsByTagName('tbody')[0];
    const newRow = table.insertRow();
    newRow.insertCell(0).innerText = table.rows.length + 1;
    const engCell = newRow.insertCell(1);
    engCell.innerText = english;
    engCell.ondblclick = function(e) {
        const turCell = newRow.cells[2];
        if (turCell) {
            showToast(turCell.innerText);
        }
    };
    newRow.insertCell(2).innerText = turkish;
    const actionsCell = newRow.insertCell(3);
    actionsCell.className = 'actions';
    saveTableToStorage();
}

function addActionButtons() {
    document.querySelectorAll('#wordsTable tbody tr').forEach((row, idx) => {
        if(row.cells.length === 4) {
            row.cells[0].innerText = (idx + 1);
        }
        row.cells[1].ondblclick = function() {
            showToast(row.cells[2].innerText);
        };
        let cell = row.querySelector('.actions');
        if(cell && cell.children.length === 0) {
            const editBtn = document.createElement('button');
            editBtn.title = 'Düzenle';
            editBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M4 13.5V16h2.5l7.1-7.1a1 1 0 0 0-1.4-1.4L5 14.6V13.5z" stroke="#2a3a5e" stroke-width="1.5"/></svg>';
            editBtn.style.background = 'none';
            editBtn.style.border = 'none';
            editBtn.style.cursor = 'pointer';
            editBtn.style.marginRight = '8px';
            editBtn.onclick = function() {
                if(confirm('Bu kelimeyi düzenlemek istediğinize emin misiniz?')) {
                    modalTitle.textContent = 'Kelimeleri Düzenle';
                    englishInput.value = row.cells[1].innerText;
                    turkishInput.value = row.cells[2].innerText;
                    editRow = row;
                    addModal.style.display = 'flex';
                }
            };
            const deleteBtn = document.createElement('button');
            deleteBtn.title = 'Sil';
            deleteBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M6 6l8 8M14 6l-8 8" stroke="#d32f2f" stroke-width="2"/></svg>';
            deleteBtn.style.background = 'none';
            deleteBtn.style.border = 'none';
            deleteBtn.style.cursor = 'pointer';
            deleteBtn.onclick = function() {
                if(confirm('Bu kelimeyi silmek istediğinize emin misiniz?')) {
                    row.remove();
                    saveTableToStorage();
                    addActionButtons();
                }
            };
            cell.appendChild(editBtn);
            cell.appendChild(deleteBtn);
        }
    });
}

$(document).ready(function() {
    $('#wordsTable').DataTable({
        language: {
            url: '//cdn.datatables.net/plug-ins/1.13.6/i18n/tr.json'
        },
        paging: true,
        searching: true,
        ordering: true,
        info: true
    });
});
// Loading gösterme fonksiyonu
function showLoading(show) {
    let loading = document.getElementById('csvLoading');
    if (!loading) {
        loading = document.createElement('div');
        loading.id = 'csvLoading';
        loading.style.position = 'fixed';
        loading.style.top = '0';
        loading.style.left = '0';
        loading.style.width = '100vw';
        loading.style.height = '100vh';
        loading.style.background = 'rgba(255,255,255,0.7)';
        loading.style.display = 'flex';
        loading.style.alignItems = 'center';
        loading.style.justifyContent = 'center';
        loading.style.zIndex = '99999';
        loading.innerHTML = '<div style="padding:32px 48px; background:#fff; border-radius:12px; box-shadow:0 2px 8px #0002; font-size:1.3em; color:#2a3a5e; display:flex; align-items:center; gap:16px;"><span class="loader" style="width:32px; height:32px; border:4px solid #e3eafc; border-top:4px solid #2a3a5e; border-radius:50%; display:inline-block; animation:spin 1s linear infinite;"></span> CSV yükleniyor...</div>';
        document.body.appendChild(loading);
        // CSS animasyonu ekle
        const style = document.createElement('style');
        style.innerHTML = '@keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }';
        document.head.appendChild(style);
    }
    loading.style.display = show ? 'flex' : 'none';
}
</script>
</body>
</html>